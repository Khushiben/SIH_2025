<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>AgriDirect | My Orders (Retailer)</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f6fff6;
            margin: 0;
            padding-bottom: 180px;
        }

        /* Navbar */
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #5D8736;
            padding: 15px 30px;
            font-size: larger;
        }

        .logo {
            display: flex;
            align-items: center;
        }

        .logo video {
            width: 50px;
            height: 50px;
            margin-right: 10px;
            border-radius: 5px;
        }

        .logo-text {
            font-size: 24px;
            font-weight: bold;
            color: white;
        }

        nav ul {
            list-style: none;
            display: flex;
        }

        nav ul li {
            margin: 0 15px;
            padding: 7px;
        }

        nav ul li a {
            text-decoration: none;
            color: white;
            font-weight: bold;
        }

        nav ul li a:hover {
            color: #F4FFC3;
        }

        /* Orders Page */
        h1 {
            text-align: center;
            margin-top: 40px;
            color: #2e7d32;
        }

        .orders-container {
            width: 90%;
            max-width: 1100px;
            margin: auto;
            margin-top: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(330px, 1fr));
            gap: 20px;
        }

.order-card {
    background: white;
    padding: 20px;
    border-left: 5px solid #2e7d32;
    border-radius: 12px;
    box-shadow: 0 3px 7px rgba(0,0,0,0.15);
    transition: all 0.25s ease;
}

.order-card:hover {
    transform: translateY(-6px) scale(1.03);
    box-shadow: 0 10px 20px rgba(0,0,0,0.22);
    cursor: pointer;
}


        .order-card h3 {
            color: #2e7d32;
            margin-bottom: 10px;
        }

        .order-info p {
            margin: 4px 0;
            font-size: 15px;
        }

        /* Footer */
        footer {
            background: white;
            color: #809D3C;
            padding: 30px 20px;
            text-align: center;
            border-top: 2px solid #5D8736;
            position: fixed;
            bottom: 0;
            width: 100%;
        }

        .footer-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            max-width: 1200px;
            margin: auto;
        }

        .footer-logo {
            display: flex;
            align-items: center;
            font-size: 22px;
            font-weight: bold;
        }

        .footer-logo video {
            width: 50px;
            height: 50px;
            margin-right: 10px;
            border-radius: 5px;
        }

        .footer-contact,
        .footer-social {
            text-align: left;
        }

        .footer-social a img {
            width: 30px;
            margin: 0 10px;
            transition: transform 0.3s ease-in-out;
        }

        .footer-social a img:hover {
            transform: scale(1.2);
        }

        .footer-copy {
            margin-top: 15px;
            font-size: 14px;
            opacity: 0.8;
        }
    </style>
</head>

<body>

    <!-- Navbar -->
    <header>
        <nav>
            <div class="logo">
                <video autoplay loop muted>
                    <source src="image/agridirect.mp4" type="video/mp4">
                </video>
                <span class="logo-text">AgriDirect</span>
            </div>

            <ul>
                <li><a href="shared_homepage.html">HOME</a></li>
                <li><a href="marketplace.html">MARKETPLACE</a></li>
                <li><a href="retailer_dashboard.html">DASHBOARD</a></li>
                <li><a href="about_us.html">ABOUT US</a></li>
                <li><a id="authLink" href="#">LOGOUT</a></li>
            </ul>
        </nav>
    </header>

    <h1>My Orders</h1>

    <!-- Orders List -->
    <div class="orders-container" id="ordersList"></div>

    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div class="footer-logo">
                <video autoplay loop muted playsinline>
                    <source src="image/logo.mp4" type="video/mp4">
                </video>
                <span>AgriDirect</span>
            </div>

            <div class="footer-contact">
                <h3>Contact Us</h3>
                <p>Email: support@agriDirect.com</p>
                <p>Phone: +91 10101 01010</p>
            </div>

            <div class="footer-social">
                <h3>Follow Us</h3>
                <a href="#"><img src="image/linkedin.png" alt="LinkedIn"></a>
                <a href="#"><img src="image/twitter.png" alt="Twitter"></a>
                <a href="#"><img src="image/instagram.png" alt="Instagram"></a>
                <a href="#"><img src="image/youtube.png" alt="YouTube"></a>
            </div>
        </div>

        <p class="footer-copy">&copy; 2025 AgriDirect. All Rights Reserved.</p>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", () => {

            const retailerId = localStorage.getItem("retailerId");

            if (!retailerId) {
                alert("Please login first!");
                window.location.href = "role.html";
                return;
            }

            // LOGOUT BUTTON
            document.getElementById("authLink").addEventListener("click", () => {
                localStorage.removeItem("retailerId");
                window.location.href = "role.html";
            });

            // FETCH ORDERS
            fetch(`http://localhost:5000/retailer/orders/${retailerId}`)
                .then(res => res.json())
                .then(data => {
                    const container = document.getElementById("ordersList");

                    if (!data.success || !data.orders || !data.orders.length) {
                        container.innerHTML = `
                            <div style="
                                grid-column: 1 / -1;
                                text-align: center;
                                padding: 40px;
                                background: white;
                                border-radius: 12px;
                                box-shadow: 0 3px 7px rgba(0,0,0,0.15);
                                
                            ">
                                <div style="font-size:60px;">ðŸ“¦</div>
                                <h2 style="color:#2e7d32; margin-top:15px;">No Orders Found</h2>
                                <p style="color:#555; font-size:15px;">You haven't received any orders yet.</p>
                            </div>
                        `;
                        return;
                    }

                    data.orders.forEach(order => {
                        container.innerHTML += `
                            <div class="order-card">
                                <h3>${order.productName}</h3>
                                <div class="order-info">
                                    <p><strong>Quantity:</strong> ${order.quantity}</p>
                                    <p><strong>Total Price:</strong> â‚¹${order.totalPrice}</p>
                                    <p><strong>From Distributor:</strong> ${order.distributorId?.companyName || "N/A"}</p>
                                    <p><strong>Date:</strong> ${new Date(order.date).toLocaleDateString()}</p>
                                </div>
                            </div>
                        `;
                    });
                });
        });
        document.addEventListener("DOMContentLoaded", () => {
    const dashboardLink = document.getElementById("dashboardLink");
    const authLink = document.getElementById("authLink");

    const userRole = localStorage.getItem("userRole");

    // FARMER
    if (userRole === "farmer") {
        dashboardLink.href = "marketplacefarmer.html";
        authLink.textContent = "LOGOUT";
        authLink.href = "#";
        authLink.onclick = () => {
            localStorage.clear();
            window.location.href = "shared_homepage.html";
        };
        return;
    }

    // CONSUMER
    if (userRole === "consumer") {
        dashboardLink.href = "consumer_dashboard.html";
        authLink.textContent = "LOGOUT";
        authLink.href = "#";
        authLink.onclick = () => {
            localStorage.clear();
            window.location.href = "shared_homepage.html";
        };
        return;
    }

    // DISTRIBUTOR
    if (userRole === "distributor" && localStorage.getItem("distributorId")) {
        dashboardLink.href = "distributor_dashboard.html";
        authLink.textContent = "LOGOUT";
        authLink.href = "#";
        authLink.onclick = () => {
            localStorage.clear();
            window.location.href = "shared_homepage.html";
        };
        return;
    }

    // RETAILER
    if (userRole === "retailer" && localStorage.getItem("retailerId")) {
        dashboardLink.href = "retailer_dashboard.html";
        authLink.textContent = "LOGOUT";
        authLink.href = "#";
        authLink.onclick = () => {
            localStorage.clear();
            window.location.href = "shared_homepage.html";
        };
        return;
    }

    // NOT LOGGED IN
    dashboardLink.href = "role.html";
    authLink.textContent = "LOGIN/SIGN UP";
    authLink.href = "role.html";
});
    </script>

</body>

</html>
